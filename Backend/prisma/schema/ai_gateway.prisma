/**
 * @license
 * Copyright (c) 2026 FairArena. All rights reserved.
 *
 * PROPRIETARY AND CONFIDENTIAL.
 *
 * This source code is the sole property of FairArena. Unauthorized copying,
 * distribution, or use of this file, via any medium, is strictly prohibited.
 *
 * This file and its contents are provided "AS IS" without warranty of any kind,
 * either express or implied, including, but not limited to, the implied
 * warranties of merchantability and fitness for a particular purpose.
 */


model AiGatewayRequest {
  id              String   @id @default(cuid())
  userId          String
  apiKeyId        String?
  model           String
  provider        String
  promptTokens    Int      @default(0)
  completionTokens Int     @default(0)
  totalTokens     Int      @default(0)
  creditsUsed     Int      @default(0)
  latencyMs       Int      @default(0)
  streaming       Boolean  @default(false)
  cached          Boolean  @default(false)
  status          AiGatewayStatus @default(SUCCESS)
  errorCode       String?
  errorMessage    String?
  ipAddress       String?
  userAgent       String?
  requestMetadata Json?
  createdAt       DateTime @default(now())
  user            User     @relation(fields: [userId], references: [userId], onDelete: Cascade)

  @@index([userId])
  @@index([apiKeyId])
  @@index([model])
  @@index([provider])
  @@index([status])
  @@index([createdAt])
  @@index([userId, createdAt])
  @@index([userId, model])
}

model AiModelStatus {
  modelId           String   @id
  displayName       String
  provider          String
  category          String
  status            ModelStatus @default(UNKNOWN)
  latencyMs         Int?
  uptimePercent     Float    @default(100)
  lastCheckedAt     DateTime?
  errorMessage      String?
  updatedAt         DateTime @updatedAt

  @@index([provider])
  @@index([status])
}

model AiModelIncident {
  id                String   @id @default(cuid())
  provider          String
  startedAt         DateTime @default(now())
  resolvedAt        DateTime?
  errorMessage      String

  @@index([provider])
  @@index([startedAt])
}

model AiModelHistory {
  id                String   @id @default(cuid())
  modelId           String
  ok                Boolean
  latencyMs         Int?
  error             String?
  createdAt         DateTime @default(now())

  @@index([modelId])
  @@index([createdAt])
}
