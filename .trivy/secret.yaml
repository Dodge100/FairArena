# Trivy secret scanning configuration
# Define custom rules for detecting secrets

rules:
  - id: 'generic-api-key'
    category: 'generic'
    title: 'Generic API Key'
    severity: 'HIGH'
    match: 'api[_-]?key\s*[:=]\s*["'']?([A-Za-z0-9_-]{20,})["'']?'

  - id: 'aws-access-key'
    category: 'aws'
    title: 'AWS Access Key'
    severity: 'CRITICAL'
    match: 'AKIA[0-9A-Z]{16}'

  - id: 'private-key'
    category: 'key'
    title: 'Private Key'
    severity: 'CRITICAL'
    match: '-----BEGIN [A-Z ]*PRIVATE KEY-----'

  - id: 'jwt-token'
    category: 'jwt'
    title: 'JWT Token'
    severity: 'HIGH'
    match: 'eyJ[A-Za-z0-9-_]+\.eyJ[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*'

# Allow list for false positives
allow-rules:
  - id: 'generic-api-key'
    paths:
      - '**/test/**'
      - '**/*.test.*'
      - '**/*.spec.*'
  - id: 'jwt-token'
    paths:
      - '**/test/**'
      - '**/*.test.*'
      - '**/*.spec.*'
